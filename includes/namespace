<h1 id="namespace-api">Namespace API</h1>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login. </span>

ROS-Service Name: /get_global_namespace
ROS-Service Type: core_api/ParamGetGlobalNamespace, below is its description

<span class="c">#Request : None</span>

<span class="c">#Response : Paramter info</span>
core_api/ParamInfo param_info
<span class="c">#Response : success=true if parameter get was successful.</span>
bool success
<span class="c">#Response : Returns error message/success message if any.</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/</span><span class="n">get_global_namespace</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/</span><span class="n">get_global_namespace</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> <span class="n">ParamGetGlobalNamespace</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">' &lt;ip&gt;/ros/get_global_namespace'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
    <span class="p">{</span>
        <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="nx">param_info</span><span class="p">:{</span>
            <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/get_global_namespace'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamGetGlobalNamespace'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
            <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /get_global_namespace <span class="s2">"{}"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/ParamGetGlobalNamespace.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">ParamGetGlobalNamespace</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/get_global_namespace"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">ParamGetGlobalNamespace</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">global_namespace</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">param_info</span><span class="p">.</span><span class="n">param_value</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">get_global_namespace</span><span class="p">():</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/get_global_namespace'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/get_global_namespace'</span><span class="p">,</span> <span class="n">ParamGetGlobalNamespace</span><span class="p">)</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">res</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">param_info</span><span class="o">.</span><span class="n">param_value</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"global namespace service not available"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/get_global_namespace"</span><span class="p">,</span>   
        <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/get_global_namespace'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamGetGlobalNamespace'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">namespace</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>param_info: 
  param_id: global_namespace
  param_value: flytpod
success: True
message: FlytOS namespace is  flytpod
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">success</span> <span class="o">:</span> <span class="nb">true</span>
<span class="n">message</span> <span class="o">:</span> <span class="n">FlytOS</span> <span class="k">namespace</span> <span class="n">is</span>  <span class="n">flytpod</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">success</span><span class="p">:</span> <span class="bp">True</span>
<span class="n">message</span><span class="p">:</span> <span class="n">FlytOS</span> <span class="n">namespace</span> <span class="ow">is</span>  <span class="n">flytpod</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
        <span class="nl">param_value</span><span class="p">:</span><span class="s1">'flytpod'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
        <span class="nl">param_value</span><span class="p">:</span><span class="s1">'flytpod'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API returns the global namespace under which FlytOS&rsquo;s instance is running. For users using RESTful, Websocket or ROS APIs, calling this API is a <strong>MUST</strong>, as the value of this namespace is required to call other APIs. In the subsequent documentation, wherever <em>&lt;namespace&gt;</em> is mentioned in API call definition, it must be replaced by the output of this API call. Users writing their code in simple CPP and Python need not call this API.</p>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<ul>
<li>Type: Ros Service</br> </li>
<li>Name: /get_global_namespace</br></li>
<li>Service Type: ParamGetGlobalNamespace</li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/get_global_namespace</code></li>
<li>JSON Response:
{
success: Boolean,
message: String,
param_info:{param_value: String}
}</li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: &lsquo;/get_global_namespace&rsquo;</br></li>
<li>serviceType: &lsquo;core_api/ParamGetGlobalNamespace&rsquo;</li>
</ul>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Global namespace is required when calling onboard/remote APIs except cpp/python APIs.</li>
<li>All the core nodes of FlytOS run inside this namespace.</li>
<li>Make sure that your custom ROS packages are not launched inside this namespace.</li>
</ul>
